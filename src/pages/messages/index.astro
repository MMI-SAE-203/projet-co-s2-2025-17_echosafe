---
import PocketBase from "pocketbase";

const pb = new PocketBase("https://pocketbase-echo-safe.fly.dev/");
const authCookie = Astro.request.headers.get("cookie");
if (authCookie) {
  pb.authStore.loadFromCookie(authCookie);
}

if (!pb.authStore.isValid) {
  return Astro.redirect("/auth/connexion");
}

return Astro.redirect("/messages/prives");
---
